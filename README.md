# Channels Application - API Documentation

This document contains the HTTP API documentation for a frontend client application.

## Introduction

This API is designed to be consumed by a frontend client application, divided by the following entities:

**Home**, the entry point of the API; 

**User**, that provides actions such as register, login and generate invites for new users;

**Channels**, that provides actions such as create, join and leave a channel according to its type (`PUBLIC` or `PRIVATE`; if the channel is `PRIVATE` an invitation is needed, this invites give user differnt permissions in the channel either `READ_ONLY` or `READ_WRITE`);

**Messages**, that provides actions such as create and delete a message from a given channel;

## Media Types

This API uses the following media types:

`application/json`, which is used in request bodies - **JSON**
`application/problem+json`, which is used in response errors - **RFC9457**

## Error Handling

All the **Problem** responses have the following properties:

- **type** - a URI reference that identifies the problem type;
- **title** - a short, human-readable summary of the problem type;
- **status** - the HTTP status code generated by the origin server for this occurrence of the problem;
- **detail** - a human-readable explanation specific to this occurrence of the problem;
- **instance** - a URI reference that identifies the specific occurrence of the problem.

## Authentication

> Authorization Header

Uses the Bearer authentication scheme.

> Cookie Header

Uses the Cookie authentication scheme.

Each user has a **max of 3 tokens**, and if a user tries to login with more than 3 tokens, the oldest token is deleted. The token has max validity of **1 hour** and expires, when this happens the user should login again to get a new token.

## Available Operations

### User

> **User Home** - The user home contains basic information of the user, namely, id and username. Requires authentication.

> **Register** - Register a new user in the system.

The request body to this request should be a **JSON object** with the following properties:

- **name** - the user's name;
- **email** - the user's email;
- **password** - the user's password (must have uppercase and lowercase letters, at least a number and a special character);
- **invite code** - the invite code to join the system.

The client application should then login the user to get a valid token that should be used in authenticated requests.

> **Login** - Login a user in the system.

The request body to this request should be a **JSON object** with the following properties:

- **name** - the user's name;
- **password** - the user's password.

This request returns a token that should be used in authenticated requests.

The token is refreshed every time an authenticated request is made.

> **Logout** - Logout a user from the system. Requires authentication.

> **Generate Invite** - Generate an invite for a new user to join the system. Requires authentication.

### Channels

> **Create Channel** - Creates a new channel in the system. Requires authentication.

The request body to this request should be a **JSON object** with the following properties:

- **name** - the channel's name;
- **type** - the channel's type (`PUBLIC` or `PRIVATE`);

This request returns a **channel object** with the following properties:

- **id** - the channel's id;

If the channel is private, the client should then generate an invite to invite users to join the channel.

> **Get Channel by ID** - Get a specific channel by id. Requires authentication.

The path variable for this request is:

- **id** - the channel's id;

This request returns a **channel object** with the following properties:

- **id** - the channel's id;
- **name** - the channel's name;
- **owner** - the channel's owner;
- **type** - the channel's type (`PUBLIC` or `PRIVATE`);
- **members** - the channel's members;
- **bannedMembers** - the channel's banned members;

> **Search Channels by Name** - Get channels by name in the system (supports pagination). Requires authentication.

The query parameters for this request are:

- **name** - the name of the channel to search for (required);
- **sort** - the direction to sort the channels by name (optional);

This request returns a **list of channel objects** with the following properties:

- **id** - the channel's id;
- **name** - the channel's name;
- **owner** - the channel's owner;
- **type** - the channel's type (`PUBLIC` or `PRIVATE`);
- **members** - the channel's members;
- **bannedMembers** - the channel's banned members;

> **Get Public Channels** - Get public channels in the system (supports pagination). Requires authentication.

The query parameters for this request are:

- **sort** - the direction to sort the channels by name (optional);

This request returns a **list of channel objects** with the following properties:

- **id** - the channel's id;
- **name** - the channel's name;
- **owner** - the channel's owner;
- **type** - the channel's type (`PUBLIC` or `PRIVATE`);
- **members** - the channel's members;
- **bannedMembers** - the channel's banned members;

> **Get Owned Channels** - Get channels that a user is a owner of. Requires authentication.

This request returns a **list of channel objects** with the following properties:

- **id** - the channel's id;
- **name** - the channel's name;
- **owner** - the channel's owner;
- **type** - the channel's type (`PUBLIC` or `PRIVATE`);
- **members** - the channel's members;
- **bannedMembers** - the channel's banned members;

> **Get Member Channels** - Get channels that a user is a member of. Requires authentication.

This request returns a **list of channel objects** with the following properties:

- **id** - the channel's id;
- **name** - the channel's name;
- **owner** - the channel's owner;
- **type** - the channel's type (`PUBLIC` or `PRIVATE`);
- **members** - the channel's members;
- **bannedMembers** - the channel's banned members;

> **Join Public Channel** - Joins a user to a public channel. Requires authentication.

The path variable for this request is:

- **id** - the channel's id;

The request body to this request should be a **JSON object** with the following properties:

- **id** - the channel's id;
- **name** - the channel's name;
- **owner** - the channel's owner;
- **type** - the channel's type (`PUBLIC` or `PRIVATE`);
- **members** - the channel's members;
- **bannedMembers** - the channel's banned members;

> **Create Private Channel Invite** - Creates an invite for a private channel. Requires authentication.

The path variable for this request is:

- **id** - the channel's id;

The request body to this request should be a **JSON object** with the following properties:

- **privacy** - the invite's privacy, which means the user's permissions in the channel (`READ_ONLY` or `READ_WRITE`);
- **username** - the invited user's name;

This request returns an **invite object** with the following properties:

- **inviteCode** - the invite's code;

> **Join Private Channel** - Joins a user to a private channel. Requires authentication.

The path variable for this request is:

- **id** - the channel's id;
- **code** - the invite code to join the channel;

The request body to this request should be a **JSON object** with the following properties:

- **status** - the invite's status (`PENDING`, `ACCEPT` or `REJECT`).

This request returns a **channel object** with the following properties:

- **id** - the channel's id;
- **name** - the channel's name;
- **owner** - the channel's owner;
- **type** - the channel's type (`PUBLIC` or `PRIVATE`);
- **members** - the channel's members;
- **bannedMembers** - the channel's banned members;

> **Get Received Invites** - Get received invites by a user. Requires authentication.

This request returns a **list of invite objects** with the following properties:

- **id** - the invite's id;
- **privacy** - the invite's privacy, which means the user's permissions in the channel (`READ_ONLY` or `READ_WRITE`);
- **status** - the invite's status (`PENDING`, `ACCEPT` or `REJECT`);
- **user** - the user object that created the invite;
- **channelId** - the channel's id;
- **channelName** - the channel's name;

> **Get Sent Invites** - Get sent invites by a user. Requires authentication.

This request returns a **list of invite objects** with the following properties:

- **id** - the invite's id;
- **privacy** - the invite's privacy, which means the user's permissions in the channel (`READ_ONLY` or `READ_WRITE`);
- **status** - the invite's status (`PENDING`, `ACCEPT` or `REJECT`);
- **user** - the user object that created the invite;
- **channelId** - the channel's id;
- **channelName** - the channel's name;

> **Update Channel** - Updates a channel in the system. Requires authentication.

The path variable for this request is:

- **id** - the channel's id;

The request body to this request should be a **JSON object** with the following properties:

- **name** - the channel's new name (optional);
- **type** - the channel's new type (`PUBLIC` or `PRIVATE`) (optional);

This request returns a **channel object** with the following properties:

- **id** - the channel's id;
- **name** - the channel's name;
- **owner** - the channel's owner;
- **type** - the channel's type (`PUBLIC` or `PRIVATE`);
- **members** - the channel's members;
- **bannedMembers** - the channel's banned members;

> **Ban Member** - Bans a user from a channel. Requires authentication.

The path variable for this request is:

- **id** - the channel's id;

The request body to this request should be a **JSON object** with the following properties:

- **username** - the banned user's name;

This request returns a **channel object** with the following properties:

- **id** - the channel's id;
- **name** - the channel's name;
- **owner** - the channel's owner;
- **type** - the channel's type (`PUBLIC` or `PRIVATE`);
- **members** - the channel's members;
- **bannedMembers** - the channel's banned members;

> **Unban Member** - Unbans a user from a channel. Requires authentication.

The path variable for this request is:

- **id** - the channel's id;

The request body to this request should be a **JSON object** with the following properties:

- **username** - the unbanned user's name;

This request returns a **channel object** with the following properties:

- **id** - the channel's id;
- **name** - the channel's name;
- **owner** - the channel's owner;
- **type** - the channel's type (`PUBLIC` or `PRIVATE`);
- **members** - the channel's members;
- **bannedMembers** - the channel's banned members;

> **Leave Channel** - Leaves a user from a channel. Requires authentication.

The path variable for this request is:

- **id** - the channel's id;

### Messages

> **Create Message** - Creates a new message in a channel. Requires authentication.

The path variable for this request is:

- **id** - the channel's id;

The request body to this request should be a **JSON object** with the following properties:

- **text** - the message's text;

This request returns an **id object** with the following properties:

- **id** - the message's id;

> **Get Channel Messages** - Get messages in a channel. Requires authentication.

The path variable for this request is:

- **id** - the channel's id;

This request returns a **list of messages** objects with the following properties:

- **id** - the message's id;
- **text** - the message's text;
- **channel** - the channel object that the message belongs to;
- **user** - the user object that created the message;
- **created** - the message's creation date;

> **Delete Message** - Deletes a message in a channel. Requires authentication.

The path variable for this request is:

- **channelId** - the channel's id;
- **id** - the message's id;
